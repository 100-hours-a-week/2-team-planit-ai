# QueryExtention

## ğŸ“ ê°œìš”

ì‚¬ìš©ì í˜ë¥´ì†Œë‚˜ë¥¼ ë¶„ì„í•˜ì—¬ **POI ê²€ìƒ‰ì— ì‚¬ìš©í•  í‚¤ì›Œë“œë¥¼ ì¶”ì¶œ**í•˜ëŠ” ëª¨ë“ˆì…ë‹ˆë‹¤. LLMì„ ì‚¬ìš©í•˜ì—¬ ì—¬í–‰ ìŠ¤íƒ€ì¼, ì·¨í–¥, ì˜ˆì‚° ë“±ì„ ê³ ë ¤í•œ ê²€ìƒ‰ í‚¤ì›Œë“œë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

> âš ï¸ **ì°¸ê³ **: í´ë”ëª…ì— ì˜¤íƒ€ê°€ ìˆìŠµë‹ˆë‹¤ (`Extention` â†’ `Extension`).

---

## ğŸ“„ íŒŒì¼

### `QueryExtention.py`

---

### ğŸ”§ ìƒìˆ˜

| ì´ë¦„ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| `KEYWORD_EXTRACTION_PROMPT` | `str` | LLMì—ê²Œ í‚¤ì›Œë“œ ì¶”ì¶œì„ ìš”ì²­í•˜ëŠ” í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ |

**í”„ë¡¬í”„íŠ¸ ì§€ì¹¨**:
- í˜ë¥´ì†Œë‚˜ì˜ ì—¬í–‰ ìŠ¤íƒ€ì¼, ì·¨í–¥, ì˜ˆì‚°, ë™í–‰ì¸ ê³ ë ¤
- ì—¬í–‰ì§€(ë„ì‹œëª…)ë¥¼ í¬í•¨í•œ êµ¬ì²´ì ì¸ ê²€ìƒ‰ì–´ ìƒì„±
- 5-10ê°œì˜ ê²€ìƒ‰ í‚¤ì›Œë“œ ìƒì„±
- ë§›ì§‘, ì¹´í˜, ê´€ê´‘ì§€, ì‡¼í•‘ ë“± ë‹¤ì–‘í•œ ì¹´í…Œê³ ë¦¬ í¬í•¨

---

### ğŸ—ï¸ í´ë˜ìŠ¤: `KeywordExtractor`

**ì„¤ëª…**: í˜ë¥´ì†Œë‚˜ ê¸°ë°˜ ì—¬í–‰ í‚¤ì›Œë“œ ì¶”ì¶œ ëª¨ë“ˆì…ë‹ˆë‹¤.

#### ğŸ“Œ í•„ë“œ (Attributes)

| í•„ë“œëª… | íƒ€ì… | ì„¤ëª… |
|--------|------|------|
| `llm` | `BaseLLMClient` | LLM í´ë¼ì´ì–¸íŠ¸ ì¸ìŠ¤í„´ìŠ¤ |

#### ğŸ”§ ë©”ì„œë“œ (Methods)

**`__init__(llm_client: BaseLLMClient)`**

- **ì„¤ëª…**: KeywordExtractor ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

---

**`extract_keywords(persona_summary: str) -> List[str]`** *(ë¹„ë™ê¸°)*

- **ì„¤ëª…**: í˜ë¥´ì†Œë‚˜ì—ì„œ ì—¬í–‰ í‚¤ì›Œë“œë¥¼ ì¶”ì¶œí•©ë‹ˆë‹¤.
- **íŒŒë¼ë¯¸í„°**:
  - `persona_summary` (`str`): ì—¬í–‰ì í˜ë¥´ì†Œë‚˜ ìš”ì•½
- **ë°˜í™˜ê°’**: `List[str]` - ì¶”ì¶œëœ ê²€ìƒ‰ í‚¤ì›Œë“œ ë¦¬ìŠ¤íŠ¸ (5-10ê°œ)

---

**`_parse_keywords(response: str) -> List[str]`** *(ë‚´ë¶€ ë©”ì„œë“œ)*

- **ì„¤ëª…**: LLM ì‘ë‹µì—ì„œ `<keyword>` íƒœê·¸ë¥¼ íŒŒì‹±í•˜ì—¬ í‚¤ì›Œë“œë¥¼ ì¶”ì¶œí•©ë‹ˆë‹¤.

---

### ğŸ—ï¸ í´ë˜ìŠ¤: `QueryExtension` *(deprecated)*

**ì„¤ëª…**: í•˜ìœ„ í˜¸í™˜ì„±ì„ ìœ„í•œ `KeywordExtractor`ì˜ ë³„ì¹­ì…ë‹ˆë‹¤.

#### ğŸ”§ ë©”ì„œë“œ (Methods)

**`expand_query(persona_summary: str) -> List[str]`** *(ë¹„ë™ê¸°, deprecated)*

- **ì„¤ëª…**: `extract_keywords`ì˜ ë³„ì¹­. ìƒˆ ì½”ë“œì—ì„œëŠ” `KeywordExtractor.extract_keywords()` ì‚¬ìš©ì„ ê¶Œì¥í•©ë‹ˆë‹¤.

---

## ğŸ”— ì˜ì¡´ì„±

- `app.core.LLMClient.BaseLlmClient`: LLM ì¶”ìƒ í´ë˜ìŠ¤
- `app.core.models.LlmClientDataclass.ChatMessageDataclass`: ë©”ì‹œì§€ ë°ì´í„° ëª¨ë¸
