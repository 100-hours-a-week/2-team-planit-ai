# QueryExtention

## ğŸ“ ê°œìš”

ì‚¬ìš©ì í˜ë¥´ì†Œë‚˜ì™€ ì—¬í–‰ ëª©ì ì§€ë¥¼ ë¶„ì„í•˜ì—¬ **POI ê²€ìƒ‰ì— ì‚¬ìš©í•  í‚¤ì›Œë“œë¥¼ ì¶”ì¶œ**í•˜ëŠ” ëª¨ë“ˆì…ë‹ˆë‹¤. LLMì„ ì‚¬ìš©í•˜ì—¬ ì—¬í–‰ ìŠ¤íƒ€ì¼, ì·¨í–¥, ì˜ˆì‚° ë“±ì„ ê³ ë ¤í•œ ì—¬í–‰ì§€ íŠ¹í™” ê²€ìƒ‰ í‚¤ì›Œë“œë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

> âš ï¸ **ì°¸ê³ **: í´ë”ëª…ì— ì˜¤íƒ€ê°€ ìˆìŠµë‹ˆë‹¤ (`Extention` â†’ `Extension`).

---

## ğŸ“„ íŒŒì¼

### `BaseKeywordExtractor.py`

í‚¤ì›Œë“œ ì¶”ì¶œ ì—ì´ì „íŠ¸ì˜ **ì¶”ìƒ ê¸°ë³¸ í´ë˜ìŠ¤**ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.

#### ğŸ—ï¸ í´ë˜ìŠ¤: `BaseKeywordExtractor(ABC)`

**ì„¤ëª…**: í‚¤ì›Œë“œ ì¶”ì¶œ ì—ì´ì „íŠ¸ê°€ êµ¬í˜„í•´ì•¼ í•˜ëŠ” ì¸í„°í˜ì´ìŠ¤ë¥¼ ì •ì˜í•˜ëŠ” ì¶”ìƒ í´ë˜ìŠ¤ì…ë‹ˆë‹¤.

##### ğŸ”§ ë©”ì„œë“œ (Methods)

**`extract_keywords(persona_summary: str) -> List[str]`** *(ì¶”ìƒ, ë¹„ë™ê¸°)*

- **ì„¤ëª…**: í˜ë¥´ì†Œë‚˜ì—ì„œ ì—¬í–‰ í‚¤ì›Œë“œë¥¼ ì¶”ì¶œí•©ë‹ˆë‹¤.
- **íŒŒë¼ë¯¸í„°**:
  - `persona_summary` (`str`): ì—¬í–‰ì í˜ë¥´ì†Œë‚˜ ìš”ì•½
- **ë°˜í™˜ê°’**: `List[str]` - ì¶”ì¶œëœ ê²€ìƒ‰ í‚¤ì›Œë“œ ë¦¬ìŠ¤íŠ¸

---

### `QueryExtention.py`

`BaseKeywordExtractor`ë¥¼ êµ¬í˜„í•œ **í‚¤ì›Œë“œ ì¶”ì¶œ ëª¨ë“ˆ**ì…ë‹ˆë‹¤.

#### ğŸ”§ ìƒìˆ˜

| ì´ë¦„ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| `KEYWORD_EXTRACTION_PROMPT` | `str` | LLMì—ê²Œ í‚¤ì›Œë“œ ì¶”ì¶œì„ ìš”ì²­í•˜ëŠ” í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ |

**í”„ë¡¬í”„íŠ¸ ì§€ì¹¨**:
- í˜ë¥´ì†Œë‚˜ì˜ ì—¬í–‰ ìŠ¤íƒ€ì¼, ì·¨í–¥, ì˜ˆì‚°, ë™í–‰ì¸ ê³ ë ¤
- ì—¬í–‰ì§€(`{destination}`)ì— íŠ¹í™”ëœ í‚¤ì›Œë“œ ìƒì„±
- ìœ ëª… ê´€ê´‘ì§€, ë¡œì»¬ ë§›ì§‘, ìˆ¨ì€ ëª…ì†Œ ë°˜ì˜
- 5-10ê°œì˜ ê²€ìƒ‰ í‚¤ì›Œë“œ ìƒì„±
- ë§›ì§‘, ì¹´í˜, ê´€ê´‘ì§€, ì‡¼í•‘, ì•¡í‹°ë¹„í‹° ë“± ë‹¤ì–‘í•œ ì¹´í…Œê³ ë¦¬ í¬í•¨
- ëª¨ë“  í‚¤ì›Œë“œì— ì—¬í–‰ì§€ëª… í¬í•¨

---

#### ğŸ—ï¸ í´ë˜ìŠ¤: `QueryExtension(BaseKeywordExtractor)`

**ì„¤ëª…**: í˜ë¥´ì†Œë‚˜ ê¸°ë°˜ ì—¬í–‰ í‚¤ì›Œë“œ ì¶”ì¶œ ëª¨ë“ˆì…ë‹ˆë‹¤. `BaseKeywordExtractor`ë¥¼ ìƒì†í•©ë‹ˆë‹¤.

##### ğŸ“Œ í•„ë“œ (Attributes)

| í•„ë“œëª… | íƒ€ì… | ì„¤ëª… |
|--------|------|------|
| `llm` | `BaseLLMClient` | LLM í´ë¼ì´ì–¸íŠ¸ ì¸ìŠ¤í„´ìŠ¤ |

##### ğŸ”§ ë©”ì„œë“œ (Methods)

**`__init__(llm_client: BaseLLMClient)`**

- **ì„¤ëª…**: QueryExtension ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

---

**`extract_keywords(persona_summary: str, destination: str) -> List[str]`** *(ë¹„ë™ê¸°)*

- **ì„¤ëª…**: í˜ë¥´ì†Œë‚˜ì™€ ì—¬í–‰ì§€ ê¸°ë°˜ìœ¼ë¡œ ê²€ìƒ‰ í‚¤ì›Œë“œë¥¼ ì¶”ì¶œí•©ë‹ˆë‹¤.
- **íŒŒë¼ë¯¸í„°**:
  - `persona_summary` (`str`): ì—¬í–‰ì í˜ë¥´ì†Œë‚˜ ìš”ì•½
  - `destination` (`str`): ì—¬í–‰ ëª©ì ì§€ (ë„ì‹œëª…)
- **ë°˜í™˜ê°’**: `List[str]` - ì¶”ì¶œëœ ê²€ìƒ‰ í‚¤ì›Œë“œ ë¦¬ìŠ¤íŠ¸ (5-10ê°œ)
- **ì°¸ê³ **: `persona_summary`ê°€ ë¹ˆ ë¬¸ìì—´ì´ë©´ ë¹ˆ ë¦¬ìŠ¤íŠ¸ ë°˜í™˜

---

**`_parse_keywords(response: str) -> List[str]`** *(ë‚´ë¶€ ë©”ì„œë“œ)*

- **ì„¤ëª…**: LLM ì‘ë‹µì—ì„œ `<keyword>` XML íƒœê·¸ë¥¼ íŒŒì‹±í•˜ì—¬ í‚¤ì›Œë“œë¥¼ ì¶”ì¶œí•©ë‹ˆë‹¤.

---

## ğŸ”— ì˜ì¡´ì„±

- `app.core.LLMClient.BaseLlmClient`: LLM ì¶”ìƒ í´ë˜ìŠ¤
- `app.core.models.LlmClientDataclass.ChatMessageDataclass`: ë©”ì‹œì§€ ë°ì´í„° ëª¨ë¸ (`ChatMessage`, `MessageData`)
- `app.core.Agents.Poi.QueryExtention.BaseKeywordExtractor`: í‚¤ì›Œë“œ ì¶”ì¶œ ì¶”ìƒ ê¸°ë³¸ í´ë˜ìŠ¤

## ğŸ”— íŒŒì¼ ê°„ ê´€ê³„

- `BaseKeywordExtractor.py`ëŠ” ì¶”ìƒ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì •ì˜í•˜ê³ , `QueryExtention.py`ì˜ `QueryExtension` í´ë˜ìŠ¤ê°€ ì´ë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤.
